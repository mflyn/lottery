# Bug 跟踪文档

## 1. 双色球复式投注蓝球命中未正确显示中奖

- **发现日期:** 2024-07-28
- **报告人:** User
- **问题描述:** 在中奖核对功能中，当使用复式投注（例如，红球选择6个或以上，蓝球选择1个或以上）时，即使用户选择的蓝球与开奖蓝球完全一致，并且红球命中数符合最低中奖条件（如0红球+1蓝球），界面仍显示"未中奖"。即使只输入单个蓝球进行测试，如果该蓝球与开奖蓝球匹配，也显示未中奖。
- **复现步骤:**
    1. 切换到"双色球"标签页。
    2. 在"中奖核对"区域输入期号（例如 2025044），点击"获取开奖号"（开奖号为 2 3 7 8 14 28 | 11）。
    3. 在"我的投注号码"区域，红球输入框输入6个或更多红球（例如 4 6 11 16 17 22）。
    4. 在"我的投注号码"区域，蓝球输入框输入包含开奖蓝球的号码（例如 3 11 15 或仅输入 11）。
    5. 点击"核对中奖"按钮。
- **预期结果:** 界面应显示中奖结果，至少提示中了六等奖 (0+1)。
- **实际结果:** 界面显示"复式中奖结果: 未中奖"。
- **当前状态:** 已在 `SSQFrame.check_prize` 中添加日志打印 `prize_summary` 以进一步诊断。
- **相关代码:**
    - `src/gui/main_window.py`: `SSQFrame.check_prize`
    - `src/core/ssq_calculator.py`: `check_complex_prize`, `_generate_complex_combinations`, `check_prize`, `PRIZE_LEVELS`

## 2. 双色球复式投注蓝球命中未正确显示中奖

- **发现日期:** 2024-07-28
- **报告人:** User
- **问题描述:** 在中奖核对功能中，当使用复式投注（例如，红球选择6个或以上，蓝球选择1个或以上）时，即使用户选择的蓝球与开奖蓝球完全一致，并且红球命中数符合最低中奖条件（如0红球+1蓝球），界面仍显示"未中奖"。即使只输入单个蓝球进行测试，如果该蓝球与开奖蓝球匹配，也显示未中奖。
- **复现步骤:**
    1. 切换到"双色球"标签页。
    2. 在"中奖核对"区域输入期号（例如 2025044），点击"获取开奖号"（开奖号为 2 3 7 8 14 28 | 11）。
    3. 在"我的投注号码"区域，红球输入框输入6个或更多红球（例如 4 6 11 16 17 22）。
    4. 在"我的投注号码"区域，蓝球输入框输入包含开奖蓝球的号码（例如 3 11 15 或仅输入 11）。
    5. 点击"核对中奖"按钮。
- **预期结果:** 界面应显示中奖结果，至少提示中了六等奖 (0+1)。
- **实际结果:** 界面显示"复式中奖结果: 未中奖"。
- **当前状态:** 已在 `SSQFrame.check_prize` 中添加日志打印 `prize_summary` 以进一步诊断。
- **预期结果:** 界面应显示中奖结果，至少提示中了六等奖 (0+1)。
- **实际结果:** 界面显示"单式中奖结果: 未中奖"或"复式中奖结果: 未中奖"。
- **根本原因:** `SSQFrame.check_prize` (及 `DLTFrame.check_prize`) 错误地使用了 `parse_numbers` 函数来解析开奖号码输入框。`parse_numbers` 会自动对数字进行排序，导致开奖号码的红球和蓝球顺序被打乱，后续的中奖判断逻辑（尤其是蓝球匹配）失效。
- **修复方案:** 修改 `check_prize` 方法，不再使用 `parse_numbers` 解析开奖号码，而是直接按空格/逗号分割字符串，转换为整数列表，并保持原始顺序（前6/5为红/前区，后1/2为蓝/后区）。
- **当前状态:** 已解决 (2024-07-28)。
- **受影响代码:**
    - `src/gui/main_window.py`: `SSQFrame.check_prize`, `DLTFrame.check_prize`
    - (间接相关) `src/gui/main_window.py`: `parse_numbers` (不应用于开奖号解析)
    - (间接相关) `src/core/ssq_calculator.py`: `check_prize` (依赖正确的 `draw_numbers` 输入)
    - (间接相关) `src/core/dlt_calculator.py`: `check_prize` (依赖正确的 `draw_numbers` 输入)

---

*(在此处添加后续发现的 Bug)* 